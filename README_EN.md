<div align="center">
    <!-- <img src="cmd/urnadb.png" style="width: 86px; height: auto; display: inline-block;"> -->
    <h1>üè∫Ô∏è</h1>
</div>

<p align="center">UrnaDB is a NoSQL database support diverse data types and transactions.</p>


---


[![Go Report Card](https://img.shields.io/badge/go%20report-A+-brightgreen.svg?style=flat)](https://img.shields.io/badge/go%20report-A+-brightgreen.svg?style=flat)
[![Go Reference](https://pkg.go.dev/badge/github.com/auula/urnadb.svg)](https://pkg.go.dev/github.com/auula/urnadb)
[![Codacy Badge](https://app.codacy.com/project/badge/Grade/55bc449808ca4d0c80c0122f170d7313)](https://app.codacy.com/gh/auula/urnadb/dashboard?utm_source=gh&utm_medium=referral&utm_content=&utm_campaign=Badge_grade)
[![codecov](https://codecov.io/gh/auula/urnadb/graph/badge.svg?token=xTcPzdLFkJ)](https://codecov.io/gh/auula/urnadb)
[![DeepSource](https://app.deepsource.com/gh/auula/urnadb.svg/?label=active+issues&show_trend=false&token=Bymkt0xcKcmlGI8WOo3JMxHc)](https://app.deepsource.com/gh/auula/urnadb/)
[![License: Apache-2.0](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![release](https://img.shields.io/github/release/auula/urnadb.svg)](https://github.com/auula/urnadb/releases)



---

[English](README_EN.md) | [ÁÆÄ‰Ωì‰∏≠Êñá](README.md)

---

## üéâ Features

- Support for multiple built-in data structures
- High throughput, low latency, efficient batch data writing
- Support for disk data storage and garbage collection
- Support for static data encryption and compression
- IP whitelist functionality for secure data access
- Data operations via RESTful API protocol

---

## üöÄ Quick Start

You can quickly deploy the [`urnadb:latest`](https://hub.docker.com/r/auula/urnadb) image using Docker to test UrnaDB services. Run the following command to pull the UrnaDB image:

```bash
docker pull auula/urnadb:latest
```

Run the UrnaDB container and map the port to the external host network with the following command:

```bash
docker run -p 2668:2668 auula/urnadb:latest
```

UrnaDB provides data interaction through RESTful APIs, theoretically supporting any HTTP protocol-capable client to access and operate UrnaDB service instances. When calling the RESTful API, you need to add `Auth-Token` in the request header for authentication. This key is automatically generated by the UrnaDB process and can be obtained from the container runtime logs. Use the following command to view the startup logs:

```text
root@2c2m:~# docker logs 66ae91bc73a6
              __  __              ___  ___
             / / / /______  ___ _/ _ \/ _ )
            / /_/ / __/ _ \/ _ `/ // / _  |
            \____/_/ /_//_/\_,_/____/____/  v1.1.2

  UrnaDB is a NoSQL database based on Log-structured file system.
  Software License: Apache 2.0  Website: https://urnadb.github.io

[UrnaDB:C] 2023/06/04 18:35:15 [WARN] The default password is: QGVkh8niwL2TSkj72icaKBC9B
[UrnaDB:C] 2023/06/04 18:35:15 [INFO] Logging output initialized successfully
[UrnaDB:C] 2023/06/04 18:35:15 [INFO] Loading and parsing region data files...
[UrnaDB:C] 2023/06/04 18:35:15 [INFO] Regions compression activated successfully
[UrnaDB:C] 2023/06/04 18:35:15 [INFO] File system setup completed successfully
[UrnaDB:C] 2023/06/04 18:35:15 [INFO] HTTP server started at http://192.168.31.221:2668 üöÄ
```

If you plan to run UrnaDB as a long-term service, it's recommended to run it directly on mainstream Linux distributions rather than using container technology. Running UrnaDB on bare metal Linux allows manual optimization of storage engine parameters for more stable performance and higher resource utilization. For specific parameter configurations, please refer to the [official documentation](https://urnadb.github.io).

---

## üïπÔ∏è RESTful API 

Currently, UrnaDB provides data interaction interfaces based on HTTP protocol's RESTful API. Any client software supporting the `HTTP` protocol can perform data operations. We recommend using `curl` for data interaction operations. UrnaDB internally provides various data structure abstractions, such as Table, List, ZSet, Set, Number, and Text types, corresponding to commonly used data structures in business code. Here's an example of RESTful API data interaction using the Table type structure.

The Table structure is similar to JSON and any semi-structured data with mapping relationships. For example, struct and class fields in programming languages can be stored using Table. Below is a Table structure JSON abstraction, where the `ttl` field sets the survival time, and the data will be automatically deleted after 120 seconds:

```json
{
    "table": {
        "is_valid": false,
        "items": [
            {
                "id": 1,
                "name": "Item 1"
            },
            {
                "id": 2,
                "name": "Item 2"
            }
        ],
        "meta": {
            "version": "2.0",
            "author": "Leon Ding"
        }
    },
    "ttl": 120
}
```

Here's an example of data storage using curl. Due to the RESTful API design style, you need to add data type information in the HTTP request path URL. Note that storage uses the HTTP PUT method, which will directly create a new data version overwriting the old one:

```bash
curl -X PUT http://localhost:2668/table/key-01 -v \
     -H "Content-Type: application/json" \
     -H "Auth-Token: QGVkh8niwL2TSkj72icaKBC9B" \
     --data @tests/table.json
```

To retrieve data, simply change the HTTP request to GET method to obtain the corresponding storage record:

```bash
curl -X GET http://localhost:2668/table/key-01 -v \
-H "Auth-Token: QGVkh8niwL2TSkj72icaKBC9B" 
```

To delete the corresponding data record, simply change the HTTP request to DELETE method:

```bash
curl -X DELETE http://localhost:2668/table/key-01 -v \
-H "Auth-Token: QGVkh8niwL2TSkj72icaKBC9B" 
```

More complex query and update operations will be supported in future version updates. For code examples of other data structure type operations, please check the [official documentation](https://urnadb.github.io).

---

## üß™ Benchmark Test

Since the underlying storage engine writes all operations to data files in an Append-Only Log manner, the test case report provided here focuses on the write performance test results of the core file system [`vfs`](./vfs/) package. The hardware configuration for running the test code is (Intel i5-7360U, 8GB LPDDR3 RAM), and the write benchmark results are as follows:

```bash
$: go test -benchmem -run=^$ -bench ^BenchmarkVFSWrite$ github.com/auula/urnadb/vfs
goos: darwin
goarch: amd64
pkg: github.com/auula/urnadb/vfs
cpu: Intel(R) Core(TM) i5-7360U CPU @ 2.30GHz
BenchmarkVFSWrite-4   	  173533	      7283 ns/op	     774 B/op	      20 allocs/op
PASS
ok  	github.com/auula/urnadb/vfs	2.806s
```

There is a [`tools.sh`](./tools.sh) utility script file in the project root directory that can quickly help complete various auxiliary tasks.

---

## üåü Stargazers over time

[![Stargazers over time](https://starchart.cc/auula/urnadb.svg?variant=adaptive)](https://starchart.cc/auula/urnadb)

---

## üë¨ Contributors

ü§ù Thanks to all the contributors below! 

![Contributors](https://contributors-img.web.app/image?repo=auula/urnadb)
